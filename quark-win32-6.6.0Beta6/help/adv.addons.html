<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
  <title>Add-Ons</title>
  <meta name="Description" content="QuArK Information Database - Page: 3.4.&nbsp;Add-Ons">
  <meta name="Keywords" content="QuArK InfoBase Quake Army Knife QRK QKM Python PY Map Editor Hexen Heretic Half-Life Sin Kingpin Soldier-of-Fortune Star-Trek-Voyager Elite-Force">
  <link rel=stylesheet href="standard.css" type="text/css">
</head>

<body>
<a name="__top__"></a>
<table width="100%" border=0 cellspacing=0>
  <tr>
    <td width=213>
      <a target="_blank" href="http://quark.sourceforge.net/"><img src="quarkicon.png" width=213 height=90 border=0 alt="Go to QuArK Web Site"></a>
    </td>
    <td width="70%" align=center>
      <div class="topheadline">Add-Ons</div>
      <div class="sm">Updated&nbsp;25 Jul 2009</div>
    </td>
    <td width="30%" valign=bottom nowrap>
      Upper&nbsp;levels:<br>-&nbsp;<a href="index.html">QuArK&nbsp;Information&nbsp;Base</a><br>-&nbsp;<a href="adv.html">3.&nbsp;Advanced&nbsp;customization</a><br>
    </td>
  </tr>
</table>
<table width="100%" border=0 cellspacing=0>
  <tr class="headline">
    <td width="99%">
      <p class="headline">&nbsp;3.4.&nbsp;Add-Ons</p>
    </td>
    <td width="1%" align=right nowrap>
      &nbsp;[&nbsp;<span class="navenable"><a href="adv.newgame.html">Prev</a></span>&nbsp;-&nbsp;<span class="navenable"><a href="adv.html">Up</a></span>&nbsp;-&nbsp;<span class="navenable"><a href="adv.python.html">Next</a></span>&nbsp;]&nbsp;
    </td>
  </tr>
</table>
<table border=0 width="100%" cellspacing=10><tr><td><p>There is old but still up-to-date information about this topic at
<a href="http://www.planetquake.com/quark/armin/q5tech.html">this page.</a>
</p>
</td></tr></table>
<br>

<table width="100%" border=0 cellspacing=0>
  <tr class="headline">
    <td width="100%">
      <p class="subheadline">&nbsp;Index</p>
    </td>
  </tr>
</table>
<ul class="index">
  <li>- <a href="#addonelements">Elements of an add-on (unfinished)</a>&nbsp;<span class="added">(25 Jul 2009)</span>
  <li>- <a href="#standards">Add-on standards for new supported games</a>&nbsp;<span class="added">(25 Jul 2009)</span>
  <li>- <a href="#entitytool">Using the entity extractor</a>&nbsp;<span class="added">(25 Jul 2009)</span>
</ul>
<br>


<a name="addonelements"></a>
  <table width="100%" border=0 cellspacing=0>
    <tr class="headline">
      <td>
        <p class="item">&nbsp;Elements of an add-on (unfinished)</p>
      </td>
      <td align=right>
        <font size=-2>Decker&nbsp;-&nbsp;25 Jul 2009</font>
      </td>
      <td width="1%" align=right nowrap>
        &nbsp;&nbsp;[&nbsp;<a href="#__top__">Top</a>&nbsp;]&nbsp;
      </td>
    </tr>
  </table>
  <table border=0 width="100%" cellspacing=10><tr><td>
<p>Also see the '.Qrk files'-section in <a href="adv.intro.html">'Introducing QuArK development'</a> for more info.
</p><div class="doccode"><pre>
<b>QQRKSRC1
{
  QuArKProtected = &quot;1&quot;
  Description = &quot;</b><i>add-on name</i>&nbsp;<b>&quot;</b>

  <i>gamename</i>&nbsp; <b>setup.qctx =
  {
    Game = &quot;</b><i>gamename</i>&nbsp;<b>&quot;
    HTML = &quot;help\index.html&quot;</b>
    <i>...misc other things</i>&nbsp;
  <b>}</b>

  <i>...other .qtx structures</i>&nbsp;
  <i>...other .qctx structures</i>&nbsp;
<b>}</b>
</pre></div>

<p>An add-on which contains new entities, must have these two .qtx and .qctx structures:
</p>
<div class="doccode"><pre>
// Structure which declares what entities are available
<i>gamename</i>&nbsp;Entities<b>.qtx =
{</b>
  <b>ToolBox = &quot;New map items...&quot;</b>
  <b>Root = &quot;</b><i>gamename</i>&nbsp; Entities<b>.qtxfolder&quot;</b>

  <i>gamename</i>&nbsp; Entities<b>.qtxfolder =
  {</b>
    <b>;desc = &quot;</b><i>short one-line description for this folder</i>&nbsp;<b>&quot;</b>

    <i>foldername</i>&nbsp;<b>.qtxfolder =
    {</b>
      // point-<u>e</u>ntity
      <i>classname</i>&nbsp;<b>:e =
      {</b>
        <b>;desc = &quot;</b><i>short one-line description of the entity</i>&nbsp;<b>&quot;</b>
        <b>origin = &quot;0 0 0&quot;</b> // If the point-entity uses a origin-point, this must be present.
        <b>angle = &quot;360&quot;</b> // If the point-entity uses an angle, this must be present.
        <i>...other initial spec/arg values</i>&nbsp;
      <b>}</b>

      // <u>b</u>rush-entity
      <i>classname</i>&nbsp;<b>:b =
      {</b>
        <b>;desc = &quot;</b><i>short one-line description of the entity</i>&nbsp;<b>&quot;</b>
        <b>;incl = &quot;defpoly&quot;</b> // This instructs QuArK that a default-polygon is to be created too.
        <b>angle = &quot;360&quot;</b> // If the brush-entity uses an angle, this must be present.
        // A brush-entity does not uses an 'origin' specific.
        <i>...other initial spec/arg values</i>&nbsp;
      <b>}</b>

      <i>...more entity declarations</i>&nbsp;
    <b>}</b>

    <i>...more folders containing entities</i>&nbsp;
  <b>}</b>
<b>}</b>

// Structure which defines the contents of available entities
<b>Entity forms.qctx =
{</b>
  // Every entity declared above, must have a :form too,
  // which defines what the entity will show in QuArK's spec/arg-view.
  <i>classname</i>&nbsp;<b>:form =
  {</b>
    <b>help = &quot;</b><i>general help description for this entity</i>&nbsp;<b>&quot;</b>
    <b>html = &quot;</b><i>URL statement</i>&nbsp;<b>&quot;</b> // Activates the default browser, which this link
    <b>bbox = '</b><i>x1 y1 z1  x2 y2 z2</i>&nbsp;<b>'</b> // If the point-entity has a bounding-box (Only point-entities)

    // Specifics with possible argument-values
    <i>specificname</i>&nbsp;<b>: =</b> // Notice the specific-name is suffixed with a colon ':'. This is important!
    <b>{</b>
      <i>...specific control statements</i>&nbsp;
    <b>}</b>

    // Example
    targetname<b>: =</b> // Notice the specific-name is suffixed with a colon ':'. This is important!
    <b>{</b>
      <b>typ = &quot;E&quot;</b> // What type of control should be used in the spec/arg-view. E = Editcontrol.
      <b>txt = &quot;&amp;&quot;</b> // What is the leading text. &amp; = use the specificname.
      <b>hint = &quot;</b>The targetname of this entity, so others can trigger it<b>&quot;</b> // Flyover-hint
    <b>}</b>

    <i>...more specific definitions for this entity</i>&nbsp;
  <b>}</b>

  <i>...more :form definitions</i>&nbsp;
<b>}</b>
</pre></div>

  </td></tr></table>
  <br>

<a name="standards"></a>
  <table width="100%" border=0 cellspacing=0>
    <tr class="headline">
      <td>
        <p class="item">&nbsp;Add-on standards for new supported games</p>
      </td>
      <td align=right>
        <font size=-2>Decker&nbsp;-&nbsp;25 Jul 2009</font>
      </td>
      <td width="1%" align=right nowrap>
        &nbsp;&nbsp;[&nbsp;<a href="#__top__">Top</a>&nbsp;]&nbsp;
      </td>
    </tr>
  </table>
  <table border=0 width="100%" cellspacing=10><tr><td>
<p>If you create a new add-on for a new game that is going to be supported by
QuArK, there are some basic standards you must include in the add-on:
<ul>
<li>The Default Room
<li>Grouping of Entities
<li>Grouping of Textures
<ul>
<li>Access of Mod &amp; Custom Textures
</ul>
<li>A Nice Layout in the Add-on Data*.QRK File
</ul>
</p>
<p><u>The Default Room</u><br>
Make sure the add-on contains a default room. You know, the one that appears
when the user wants to create a new map. The default room must be made of 4
walls, one floor and one sky/ceiling. It must also have one spawn-point for
the player and a single white light in the center of the room.
</p>
<p>It is utterly important that you remember to place the player spawn-point
correctly. Its bounding-box must not intersect any of the brushes that the
room is made of. Else when the user tries to play the default room, he will be
stuck to the floor upon spawning, and we don't want that.
</p>
<p><u>Grouping of Entities</u><br>
Try to place the game's entities, into folders of identical behaviour. For
instance, place weapons and ammo into an <i>Weapons &amp; Ammo Entities</i>&nbsp;
folder, and trigger entities into an <i>Trigger_ Entities</i>&nbsp; folder.
</p>
<p>Take a look at the existing add-ons for the other supported games, and get
inspired.
</p>
<p><u>Grouping of Textures</u><br>
Placing textures into sub-folders in the texture-browser, is something that
takes lot of time, and you won't always create a perfect grouping of textures.
</p>
<p>A good suggestion would be, that if the game itself already have placed
its textures into sub-directories (in a PAK file or similar), then try to
follow that structure too.
</p>
<p>You may need to sort and group the textures, directly in the add-on .QRK
text-file, this will usually be a little bit faster, if you have all the
texture filenames ready at hand.
</p>
<p><ul><u>
<li>Access of Mod &amp; Custom Textures
</u><br>
</ul>
</p><p>Another way of setting up access to textures for Mods and Custom Textures
is to use the blanket command name &quot;build&quot; with a value of &quot;1&quot; setting.
This is covered in detail in the 
<a href="adv.newgame.html#gamedata">Game Data Addons</a> section.
</p><p>Basically what this does is tell QuArK to search the given path folder for
all texture folders and files in all .pak files, no matter what their name
is, and folders that have been named &quot;textures&quot; and, if the game supports
them, &quot;scripts&quot; which are shader texture files like the ones used in Quake 3.
</p><p>In addition, any custom textures and shader files will also be included
that are placed in the &quot;textures&quot; and &quot;scripts&quot; folders or in their own
sub-folder placed in these folders, with any name you wish to give them.
These custom sub-folders can also have sub-folder within them as well for
a better grouping of files. All of the folders will then be grouped in the
<a href="intro.texturebrowser.overview.html">Texture Browser</a> under the
caption &quot;Directories&quot; and will be displayed by their individual folder and
sub-folder names.
</p>
<p><u>A Nice Layout in the Add-on Data*.QRK File</u><br>
Since add-on .QRK files need to be modified now and then, when bug-fixes and
other relevant information about the game becomes available, you should keep a
nice layout in the add-on file.
</p>
<p>By this, I mean you should keep the indent-levels and try to place the
information into columns. Take for instance this structure:
</p>
<div class="doccode"><pre>
Valve Textures.qtxfolder =
{
  Spraypaing.txlist =
  {
    8BALL1.wl =
    {
      s = &quot;valve&quot;
      d = &quot;spraypaint&quot;
      h = &quot;C&quot;
    }
    ANDRE.wl =
    {
      s = &quot;valve&quot;
      d = &quot;spraypaint&quot;
      h = &quot;C&quot;
    }
    CAMP1.wl =
    {
      s = &quot;valve&quot;
      d = &quot;spraypaint&quot;
      h = &quot;C&quot;
    }
<i>..etc..</i>&nbsp;
  }
}
</pre></div>

<p>It can be made much more readable and smaller, if you put one texture-link
on one line, and also use the ':incl' feature. Notice also that I've put some
of the information into columns, so it will be easier to sort or block-mark if
you have a text-editor thats capable of block-column-marking:
</p>
<div class="doccode"><pre>
t_spraypaint:incl = { s = &quot;valve&quot; d = &quot;spraypaint&quot; h = &quot;C&quot; }

Valve Textures.qtxfolder =
{
  Spraypaint.txlist =
  {
    8BALL1.wl = { t_spraypaint = ! }
    ANDRE.wl =  { t_spraypaint = ! }
    CAMP1.wl =  { t_spraypaint = ! }
<i>..etc..</i>&nbsp;
  }
}
</pre></div>

  </td></tr></table>
  <br>

<a name="entitytool"></a>
  <table width="100%" border=0 cellspacing=0>
    <tr class="headline">
      <td>
        <p class="item">&nbsp;Using the entity extractor</p>
      </td>
      <td align=right>
        <font size=-2>Andy&nbsp;-&nbsp;25 Jul 2009</font>
      </td>
      <td width="1%" align=right nowrap>
        &nbsp;&nbsp;[&nbsp;<a href="#__top__">Top</a>&nbsp;]&nbsp;
      </td>
    </tr>
  </table>
  <table border=0 width="100%" cellspacing=10><tr><td>
<p>The easiest &amp; probably the quickest way to create a QuArK addon for an existing mod is to use the entity extractor. This basically searches through the existing <a href="glossary.html#fileext">.bsp</a> files and creates an addon based upon any new entities found.<br>
<br>
It is best to use a &quot;Game Context&quot; which tell QuArK which game the addon if for and which directories to look in for game files. To create one of these, first create a new file <span class="act">'File -&gt; New File'</span>, then create a &quot;Game Context&quot;, <span class="act">'Toolboxes -&gt; New Files...'</span> and double click on &quot;Game Context&quot;. Your QuArK window should look something like this:<br>
<img src="adv.addons.gamecontext.png">
<br>
<br>
Next, you need to specify the game and mod directories you want (for example, Game: Quake 1, Source Dir: Slide, Game Dir: Slide). Then click the &quot;Get entities for this game&quot; button. The new entities will then be found, and some texture links made. Note: this may take a long time depending on the mod's size and the number of .bsp files found.<br>
<img src="adv.addons.gamecontext2.png">
<br>
<br>
<span class="act">'Toolboxes -&gt; New map items...'</span> to see the new items:<br>
<img src="adv.addons.newmapitems.png"></p>
  </td></tr></table>
  <br>

<br>

<table width="100%" border=0 cellspacing=0>
  <tr class="headline">
    <td width="99%" align=center>
      <p class="sm">
        Copyright (c) 2009, GNU General Public License by The QuArK (Quake Army Knife) Community - <a target="_blank" href="http://quark.sourceforge.net/">http://quark.sourceforge.net/</a><br>
      </p>
    </td>
    <td width="1%" align=right nowrap>
      &nbsp;[&nbsp;<span class="navenable"><a href="adv.newgame.html">Prev</a></span>&nbsp;-&nbsp;<a href="#__top__">Top</a>&nbsp;-&nbsp;<span class="navenable"><a href="adv.python.html">Next</a></span>&nbsp;]&nbsp;
    </td>
  </tr>
</table>
</body>
</html>